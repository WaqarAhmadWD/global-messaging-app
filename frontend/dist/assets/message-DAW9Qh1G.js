import{_ as p,r as h,u as j,j as D,n as m,s as b,c as l,F as S,k as M,l as T,a as s,m as q,v as B,p as C,q as $,t as L,o as i,x as w,y as _}from"./index-OrdpqjC5.js";import{_ as N,a as V}from"./send-BRNNo5Pw.js";const A={key:0,class:"flex gap-2 items-center justify-self-end"},F={class:"bg-gray-700 px-4 py-2 rounded-full"},H={key:1,class:"flex gap-2 items-center justify-self-start"},z={class:"bg-gray-700 px-4 py-2 rounded-full"},E={key:1,class:"w-full flex justify-center items-center text-2xl font-bold h-[50vh]"},I={key:2,class:"w-full animate-pulse grid gap-2 pt-16 p-4"},O={class:"w-full p-2 flex lg:bg-[#63636388] bg-[#474747] rounded-full items-center"},P={__name:"message",props:{id:{type:String,required:!0},name:{type:String,required:!0}},setup(x){const y=L(),r=h(null),n=h(null),u=h(null),c=j(),e=x,g=async(d=null,a=!1)=>{var o,t;const v=await c.fetchData({url:`/message/get/${e==null?void 0:e.id}`,cache:d,refresh:a});((t=(o=r.value)==null?void 0:o.data)==null?void 0:t.length)===0&&m(()=>f()),r.value=v},f=()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)};D(async()=>{var d;await g(`message-${e==null?void 0:e.id}`,!1),((d=y==null?void 0:y.query)==null?void 0:d.notification)>0&&await c.fetchData({url:"/contact/get",cache:"contact",refresh:!0}),m(()=>f())}),b.on("message",async()=>{console.log("Message received"),g?(await g(`message-${e==null?void 0:e.id}`,!0),m(()=>f())):console.error("fetchData is undefined")});const k=async()=>{n.value&&(e!=null&&e.id)&&(await c.fetchData({url:`/message/send/${e==null?void 0:e.id}`,method:"POST",data:{message:n.value}}),await c.fetchData({url:"/contact/get",cache:"contact",refresh:!0}),b.emit("message",{id:e==null?void 0:e.id,name:e==null?void 0:e.name}),n.value="",await g(!1,!1),m(()=>f()))};return(d,a)=>{var v,o;return i(),l("div",null,[r.value?(i(),l("div",{key:0,ref_key:"chatContainer",ref:u,class:"mt-[6rem] overflow-y-auto lg:h-[calc(100vh-12rem)] h-[calc(100vh-16rem)]"},[(i(!0),l(S,null,M((v=r.value)!=null&&v.data?r.value.data:[],t=>(i(),l("div",{key:t._id,class:"p-4 grid items-center w-full"},[t.receiver===(e==null?void 0:e.id)?(i(),l("div",A,[s("div",F,w(t==null?void 0:t.message),1),a[1]||(a[1]=s("img",{src:_,alt:"",class:"w-8 h-8"},null,-1))])):(i(),l("div",H,[a[2]||(a[2]=s("img",{src:_,alt:"",class:"w-8 h-8"},null,-1)),s("div",z,w(t==null?void 0:t.message),1)]))]))),128))],512)):((o=n.value)==null?void 0:o.length)<1?(i(),l("div",E," No public contact yet ")):(i(),l("div",I,a[3]||(a[3]=[T('<div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-5ae1724c></div><div class="lg:h-12 h-8 w-[40%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-5ae1724c></div><div class="lg:h-12 h-8 w-1/2 bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-5ae1724c></div><div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-5ae1724c></div><div class="lg:h-12 h-8 w-[80%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-5ae1724c></div><span class="sr-only" data-v-5ae1724c>Loading...</span>',6)]))),s("form",{onSubmit:$(k,["prevent"]),class:"py-4 lg:px-32 px-2 justify-between -translate-y-16 lg:translate-y-0 fixed bottom-0 form-container"},[s("div",O,[q(s("input",{type:"text",class:"w-full border-none outline-none grow bg-transparent pl-4","onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),placeholder:"Message Here!"},null,512),[[B,n.value]]),a[5]||(a[5]=s("img",{src:N,alt:"",class:"w-6 h-6 mr-2"},null,-1)),s("button",{class:C(["p-2 rounded-full",[n.value?"bg-[#A052C6]":"bg-gray-900"]]),type:"submit"},a[4]||(a[4]=[s("img",{src:V,alt:"",class:"md:w-6 md:h-6"},null,-1)]),2)])],32)])}}},G=p(P,[["__scopeId","data-v-5ae1724c"]]);export{G as default};
