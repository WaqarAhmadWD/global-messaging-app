import{_ as k,r as v,u as p,j,n as f,s as b,c as l,F as S,k as D,l as M,a as s,m as T,v as B,p as C,q as $,o as d,t as h,x as w}from"./index-BbD8gIvh.js";const q="/images/attach.svg",L="/images/send.svg",N={key:0,class:"flex gap-2 items-center justify-self-end"},V={class:"bg-gray-700 px-4 py-2 rounded-full"},A={key:1,class:"flex gap-2 items-center justify-self-start"},F={class:"bg-gray-700 px-4 py-2 rounded-full"},H={key:1,class:"w-full flex justify-center items-center text-2xl font-bold h-[50vh]"},z={key:2,class:"w-full animate-pulse grid gap-2 pt-16 p-4"},E={class:"w-full p-2 flex lg:bg-[#63636388] bg-[#474747] rounded-full items-center"},I={__name:"message",props:{id:{type:String,required:!0},name:{type:String,required:!0}},setup(_){const i=v(null),n=v(null),o=v(null),m=p(),e=_,u=async(y=null,a=!1)=>{var r,t;const c=await m.fetchData({url:`/message/get/${e==null?void 0:e.id}`,cache:y,refresh:a});((t=(r=i.value)==null?void 0:r.data)==null?void 0:t.length)===0&&f(()=>g()),i.value=c},g=()=>{o.value&&(o.value.scrollTop=o.value.scrollHeight)};j(async()=>{await u(`message-${e==null?void 0:e.id}`,!1),f(()=>g())}),b.on("message",async()=>{console.log("Message received"),u?(await u(`message-${e==null?void 0:e.id}`,!0),f(()=>g())):console.error("fetchData is undefined")});const x=async()=>{n.value&&(e!=null&&e.id)&&(await m.fetchData({url:`/message/send/${e==null?void 0:e.id}`,method:"POST",data:{message:n.value},message:!1,loading:!1}),b.emit("message",{id:e==null?void 0:e.id,name:e==null?void 0:e.name}),n.value="",await u(!1,!1),f(()=>g()))};return(y,a)=>{var c,r;return d(),l("div",null,[i.value?(d(),l("div",{key:0,ref_key:"chatContainer",ref:o,class:"mt-[6rem] overflow-y-auto lg:h-[calc(100vh-12rem)] h-[calc(100vh-16rem)]"},[(d(!0),l(S,null,D((c=i.value)!=null&&c.data?i.value.data:[],t=>(d(),l("div",{key:t._id,class:"p-4 grid items-center w-full"},[t.receiver===(e==null?void 0:e.id)?(d(),l("div",N,[s("div",V,h(t==null?void 0:t.message),1),a[1]||(a[1]=s("img",{src:w,alt:"",class:"w-8 h-8"},null,-1))])):(d(),l("div",A,[a[2]||(a[2]=s("img",{src:w,alt:"",class:"w-8 h-8"},null,-1)),s("div",F,h(t==null?void 0:t.message),1)]))]))),128))],512)):((r=n.value)==null?void 0:r.length)<1?(d(),l("div",H," No public contact yet ")):(d(),l("div",z,a[3]||(a[3]=[M('<div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-261d6d2d></div><div class="lg:h-12 h-8 w-[40%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-261d6d2d></div><div class="lg:h-12 h-8 w-1/2 bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-261d6d2d></div><div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-261d6d2d></div><div class="lg:h-12 h-8 w-[80%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-261d6d2d></div><span class="sr-only" data-v-261d6d2d>Loading...</span>',6)]))),s("form",{onSubmit:$(x,["prevent"]),class:"py-4 lg:px-32 px-2 justify-between -translate-y-16 lg:translate-y-0 fixed bottom-0 form-container"},[s("div",E,[T(s("input",{type:"text",class:"w-full border-none outline-none grow bg-transparent pl-4","onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),placeholder:"Message Here!"},null,512),[[B,n.value]]),a[5]||(a[5]=s("img",{src:q,alt:"",class:"w-6 h-6 mr-2"},null,-1)),s("button",{class:C(["p-2 rounded-full",[n.value?"bg-[#A052C6]":"bg-gray-900"]]),type:"submit"},a[4]||(a[4]=[s("img",{src:L,alt:"",class:"md:w-6 md:h-6"},null,-1)]),2)])],32)])}}},P=k(I,[["__scopeId","data-v-261d6d2d"]]);export{P as default};
