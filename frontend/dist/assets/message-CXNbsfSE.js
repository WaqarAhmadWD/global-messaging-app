import{_ as p,r as h,u as j,j as D,n as m,s as b,c as l,F as S,k as M,l as T,a as s,m as q,v as B,p as C,q as $,t as L,o as n,x as w,y as _}from"./index-WlFzHHPB.js";const N="/images/attach.svg",V="/images/send.svg",A={key:0,class:"flex gap-2 items-center justify-self-end"},F={class:"bg-gray-700 px-4 py-2 rounded-full"},H={key:1,class:"flex gap-2 items-center justify-self-start"},z={class:"bg-gray-700 px-4 py-2 rounded-full"},E={key:1,class:"w-full flex justify-center items-center text-2xl font-bold h-[50vh]"},I={key:2,class:"w-full animate-pulse grid gap-2 pt-16 p-4"},O={class:"w-full p-2 flex lg:bg-[#63636388] bg-[#474747] rounded-full items-center"},P={__name:"message",props:{id:{type:String,required:!0},name:{type:String,required:!0}},setup(x){const y=L(),r=h(null),i=h(null),u=h(null),c=j(),e=x,f=async(d=null,t=!1)=>{var o,a;const v=await c.fetchData({url:`/message/get/${e==null?void 0:e.id}`,cache:d,refresh:t});((a=(o=r.value)==null?void 0:o.data)==null?void 0:a.length)===0&&m(()=>g()),r.value=v},g=()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)};D(async()=>{var d;await f(`message-${e==null?void 0:e.id}`,!1),((d=y==null?void 0:y.query)==null?void 0:d.notification)>0&&await c.fetchData({url:"/contact/get",cache:"contact",refresh:!0}),m(()=>g())}),b.on("message",async()=>{console.log("Message received"),f?(await f(`message-${e==null?void 0:e.id}`,!0),m(()=>g())):console.error("fetchData is undefined")});const k=async()=>{i.value&&(e!=null&&e.id)&&(await c.fetchData({url:`/message/send/${e==null?void 0:e.id}`,method:"POST",data:{message:i.value}}),await c.fetchData({url:"/contact/get",cache:"contact",refresh:!0}),b.emit("message",{id:e==null?void 0:e.id,name:e==null?void 0:e.name}),i.value="",await f(!1,!1),m(()=>g()))};return(d,t)=>{var v,o;return n(),l("div",null,[r.value?(n(),l("div",{key:0,ref_key:"chatContainer",ref:u,class:"mt-[6rem] overflow-y-auto lg:h-[calc(100vh-12rem)] h-[calc(100vh-16rem)]"},[(n(!0),l(S,null,M((v=r.value)!=null&&v.data?r.value.data:[],a=>(n(),l("div",{key:a._id,class:"p-4 grid items-center w-full"},[a.receiver===(e==null?void 0:e.id)?(n(),l("div",A,[s("div",F,w(a==null?void 0:a.message),1),t[1]||(t[1]=s("img",{src:_,alt:"",class:"w-8 h-8"},null,-1))])):(n(),l("div",H,[t[2]||(t[2]=s("img",{src:_,alt:"",class:"w-8 h-8"},null,-1)),s("div",z,w(a==null?void 0:a.message),1)]))]))),128))],512)):((o=i.value)==null?void 0:o.length)<1?(n(),l("div",E," No public contact yet ")):(n(),l("div",I,t[3]||(t[3]=[T('<div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-7dff188f></div><div class="lg:h-12 h-8 w-[40%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-7dff188f></div><div class="lg:h-12 h-8 w-1/2 bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-7dff188f></div><div class="lg:h-12 h-8 w-[30%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-end" data-v-7dff188f></div><div class="lg:h-12 h-8 w-[80%] bg-gray-200 rounded-full dark:bg-gray-700 lg:mb-2 justify-self-start" data-v-7dff188f></div><span class="sr-only" data-v-7dff188f>Loading...</span>',6)]))),s("form",{onSubmit:$(k,["prevent"]),class:"py-4 lg:px-32 px-2 justify-between -translate-y-16 lg:translate-y-0 fixed bottom-0 form-container"},[s("div",O,[q(s("input",{type:"text",class:"w-full border-none outline-none grow bg-transparent pl-4","onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a),placeholder:"Message Here!"},null,512),[[B,i.value]]),t[5]||(t[5]=s("img",{src:N,alt:"",class:"w-6 h-6 mr-2"},null,-1)),s("button",{class:C(["p-2 rounded-full",[i.value?"bg-[#A052C6]":"bg-gray-900"]]),type:"submit"},t[4]||(t[4]=[s("img",{src:V,alt:"",class:"md:w-6 md:h-6"},null,-1)]),2)])],32)])}}},U=p(P,[["__scopeId","data-v-7dff188f"]]);export{U as default};
